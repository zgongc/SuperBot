{#
    Strategy Editor - Exit Strategy Partial
    Take profit, stop loss, trailing ve break-even
#}
<div class="accordion-item">
    <div class="accordion-header" onclick="toggleAccordion(this)">
        <div class="accordion-title-section">
            <div class="accordion-icon">üö™</div>
            <div class="accordion-title-text">
                <h3>Exit Strategy</h3>
                <p>Take profit, stop loss, trailing and break-even</p>
            </div>
        </div>
        <svg class="accordion-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </div>
    <div class="accordion-content">
        <div class="accordion-body">
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TAKE PROFIT -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary);">
                üí∞ TAKE PROFIT
            </div>

            <!-- TP Methods and Parameters Side by Side -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: start;">
                <div class="form-group" style="margin: 0;">
                    <label class="form-label">
                        Method
                        <span class="form-help" title="Take profit calculation method">‚ÑπÔ∏è</span>
                    </label>
                    <select class="form-select" id="es-tp-method" onchange="updateTPMethodParams(this.value)">
                        <option value="fixed_percent">üìä Fixed Percentage</option>
                        <option value="fixed_price">üíµ Fixed Price</option>
                        <option value="risk_reward" selected>üéØ Risk/Reward</option>
                        <option value="atr_based">üìà ATR Based</option>
                        <option value="fibonacci">üåÄ Fibonacci</option>
                        <option value="dynamic_ai">ü§ñ AI Dynamic</option>
                    </select>
                </div>

                <!-- TP Dynamic Parameters -->
                <div id="tp-method-params">
                    <!-- JavaScript will fill this. -->
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- STOP LOSS -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary);">
                üõë STOP LOSS
            </div>

            <!-- SL Method and Parameters Side by Side -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; align-items: start;">
                <div class="form-group" style="margin: 0;">
                    <label class="form-label">
                        Method
                        <span class="form-help" title="Stop loss calculation method">‚ÑπÔ∏è</span>
                    </label>
                    <select class="form-select" id="es-sl-method" onchange="updateSLMethodParams(this.value)">
                        <option value="fixed_percent" selected>üìä Fixed Percentage</option>
                        <option value="atr_based">üìà ATR Based</option>
                        <option value="swing_point">üìç Swing Point</option>
                        <option value="support_resistance">üéöÔ∏è Support/Resistance</option>
                        <option value="volatility_based">üìä Volatilite</option>
                        <option value="ai_adaptive">ü§ñ AI Adaptive</option>
                    </select>
                </div>

                <!-- SL Dynamic Parameters -->
                <div id="sl-method-params">
                    <!-- JavaScript will fill this. -->
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TRAILING STOP LOSS -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center;">
                <span>üìâ TRAILING STOP LOSS</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="es-trailing-stop-enabled" onchange="toggleTrailingStopConfig()">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="trailing-stop-config" class="collapsible-config">
                <div class="params-container" style="margin-top: 1rem;">
                    <div class="form-help-text" style="margin-bottom: 1rem;">Stop loss'u price with together up pull, protect the profit.</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                Callback %
                                <span class="form-help" title="If the price drops this much from the peak, the position will be closed.">‚ÑπÔ∏è</span>
                            </label>
                            <input type="number" class="form-input" id="es-trailing-callback" value="0.4" min="0.1" max="5" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                Activation Percentage
                                <span class="form-help" title="When there is so much snow, trailing starts.">‚ÑπÔ∏è</span>
                            </label>
                            <input type="number" class="form-input" id="es-trailing-activation" value="1.0" min="0" max="10" step="0.1">
                        </div>
                    </div>

                    <!-- Example Box -->
                    <div style="margin-top: 0.75rem; padding: 0.5rem; background: var(--bg-primary); border: 1px solid var(--border-primary); border-radius: 0.375rem; font-size: 0.8125rem;">
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">üí° Example:</div>
                        <div style="color: var(--text-secondary); line-height: 1.5;">
                            Input: $100, Price increased to $105 -> SL: $104.58 ($105 - 0.4%)<br>
                            Price dropped to $103 -> SL: $104.58 (fixed, will not go down!)<br>
                            Price dropped to $104.58 -> Close position, $4.58 profit!
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- TRAILING TAKE PROFIT -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center;">
                <span>üìà TRAILING TAKE PROFIT</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="es-trailing-tp-enabled" onchange="toggleTrailingTPConfig()">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="trailing-tp-config" class="collapsible-config">
                <div class="params-container" style="margin-top: 1rem;">
                    <div class="form-help-text" style="margin-bottom: 1rem;">When you reach TP, follow it to get more profit.</div>
                    <div class="form-group">
                        <label class="form-label">
                            Trailing Distance %
                            <span class="form-help" title="If the price drops this much from the peak, the position will be closed.">‚ÑπÔ∏è</span>
                        </label>
                        <input type="number" class="form-input" id="es-trailing-distance" value="0.2" min="0.1" max="5" step="0.1">
                    </div>

                    <!-- Example Box -->
                    <div style="margin-top: 0.75rem; padding: 0.5rem; background: var(--bg-primary); border: 1px solid var(--border-primary); border-radius: 0.375rem; font-size: 0.8125rem;">
                        <div style="font-weight: 600; margin-bottom: 0.25rem;">üí° Example:</div>
                        <div style="color: var(--text-secondary); line-height: 1.5;">
                            Input: $100, TP: $110<br>
                            Price reached $110 -> Trailing TP started! üöÄ<br>
                            Price went up to $115 -> TP: $114.77 ($115 - 0.2%)<br>
                            Price dropped to $114.77 -> Close, $14.77 profit! (Normal TP: $10)
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- BREAK-EVEN -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center;">
                <span>‚öñÔ∏è BREAK-EVEN</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="es-breakeven-enabled" onchange="toggleBreakevenConfig()">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="breakeven-config" class="collapsible-config">
                <div class="params-container" style="margin-top: 1rem;">
                    <div class="form-help-text" style="margin-bottom: 1rem;">Set the stop loss to the entry price for a specific profit.</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                Trigger Car %
                                <span class="form-help" title="When there is this much snow, the break-even point becomes active.">‚ÑπÔ∏è</span>
                            </label>
                            <input type="number" class="form-input" id="es-breakeven-trigger" value="1.0" min="0.1" max="10" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                Offset %
                                <span class="form-help" title="Set stop above/below the entry price.">‚ÑπÔ∏è</span>
                            </label>
                            <input type="number" class="form-input" id="es-breakeven-offset" value="0.1" min="0" max="1" step="0.01">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- PARTIAL EXIT -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center;">
                <span>üìä PARTIAL EXIT (Gradual Exit)</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="es-partial-enabled" onchange="togglePartialExitConfig()">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="partial-exit-config" class="collapsible-config">
                <div class="params-container" style="margin-top: 1rem;">
                    <div class="form-help-text" style="margin-bottom: 1rem;">Close a portion of the position at specific profit levels.</div>
                    <!-- Plan Title -->
                    <div style="background: var(--bg-secondary); border: 2px solid var(--border-primary); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                        <div style="font-weight: 600; font-size: 0.9375rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-primary);">
                            üìä Gradual Exit Plan
                        </div>

                        <!-- Level 1 -->
                        <div class="partial-exit-visual-row">
                            <div class="partial-level-badge">1Ô∏è‚É£</div>
                            <div class="partial-level-inputs-wrapper">
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-profit-level" id="es-partial-level-1" value="5" min="0.1" max="100" step="0.1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% profit</span>
                                </div>
                                <span style="margin: 0 0.5rem; color: var(--text-secondary); font-weight: 600;">‚Üí</span>
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-exit-size" id="es-partial-size-1" value="40" min="1" max="100" step="1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% out</span>
                                </div>
                            </div>
                            <div class="partial-progress-bar">
                                <div class="partial-progress-fill" id="es-partial-bar-1" style="width: 40%;"></div>
                            </div>
                        </div>

                        <!-- Level 2 -->
                        <div class="partial-exit-visual-row">
                            <div class="partial-level-badge">2Ô∏è‚É£</div>
                            <div class="partial-level-inputs-wrapper">
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-profit-level" id="es-partial-level-2" value="10" min="0.1" max="100" step="0.1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% profit</span>
                                </div>
                                <span style="margin: 0 0.5rem; color: var(--text-secondary); font-weight: 600;">‚Üí</span>
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-exit-size" id="es-partial-size-2" value="40" min="1" max="100" step="1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% out</span>
                                </div>
                            </div>
                            <div class="partial-progress-bar">
                                <div class="partial-progress-fill" id="es-partial-bar-2" style="width: 40%;"></div>
                            </div>
                        </div>

                        <!-- Level 3 -->
                        <div class="partial-exit-visual-row">
                            <div class="partial-level-badge">3Ô∏è‚É£</div>
                            <div class="partial-level-inputs-wrapper">
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-profit-level" id="es-partial-level-3" value="25" min="0.1" max="100" step="0.1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% profit</span>
                                </div>
                                <span style="margin: 0 0.5rem; color: var(--text-secondary); font-weight: 600;">‚Üí</span>
                                <div style="position: relative; flex: 1;">
                                    <input type="number" class="form-input partial-exit-size" id="es-partial-size-3" value="20" min="1" max="100" step="1" style="padding-right: 2.5rem;">
                                    <span class="input-suffix">% out</span>
                                </div>
                            </div>
                            <div class="partial-progress-bar">
                                <div class="partial-progress-fill" id="es-partial-bar-3" style="width: 20%;"></div>
                            </div>
                        </div>

                        <!-- Divider -->
                        <div style="border-top: 2px solid var(--border-primary); margin: 1rem 0;"></div>

                        <!-- Total -->
                        <div class="partial-exit-visual-row" style="background: var(--bg-primary); padding: 0.75rem; border-radius: 0.375rem;">
                            <div style="font-weight: 700; font-size: 1rem; color: var(--text-primary);">üí∞ Total:</div>
                            <div class="partial-progress-bar" style="flex: 1;">
                                <div class="partial-progress-fill" id="es-partial-bar-total" style="width: 100%; background: linear-gradient(90deg, #10b981, #059669);"></div>
                            </div>
                            <div style="font-weight: 700; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span id="es-partial-total">100%</span>
                                <span id="es-partial-check">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <!-- AI DYNAMIC EXIT -->
            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <div class="section-header" style="margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border-primary); font-weight: 600; color: var(--text-primary); display: flex; justify-content: space-between; align-items: center;">
                <span>ü§ñ AI DYNAMIC EXIT (AI Dynamic Exit Optimization)</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="es-ai-exit-enabled" onchange="toggleAIExitConfig()">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div id="ai-exit-config" class="collapsible-config">
                <div class="params-container" style="margin-top: 1rem;">
                    <div class="form-help-text" style="margin-bottom: 1rem;">
                        It performs dynamic TP/SL optimization using an AI model. It automatically adjusts the targets according to the market regime (trend, range, volatile).
                    </div>

                    <!-- Model Configuration -->
                    <div style="background: var(--bg-secondary); border: 2px solid var(--border-primary); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                        <div style="font-weight: 600; font-size: 0.9375rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-primary);">
                            üß† Model Settings
                        </div>

                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label class="form-label">
                                    Model Yolu
                                    <span class="label-help" title="Path to the trained AI model file.">‚ÑπÔ∏è</span>
                                </label>
                                <input type="text" class="form-input" id="ai-exit-model-path" value="data/models/exit_optimizer_v1.pkl" placeholder="data/models/exit_optimizer_v1.pkl">
                            </div>

                            <div class="form-group" style="flex: 1;">
                                <label class="form-label">
                                    Tahmin Ufku (bar)
                                    <span class="label-help" title="How many bars ahead will it predict?">‚ÑπÔ∏è</span>
                                </label>
                                <input type="number" class="form-input" id="ai-exit-prediction-horizon" value="50" min="10" max="500" step="10">
                            </div>
                        </div>
                    </div>

                    <!-- Dynamic Adjustments -->
                    <div style="background: var(--bg-secondary); border: 2px solid var(--border-primary); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                        <div style="font-weight: 600; font-size: 0.9375rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-primary);">
                            ‚öôÔ∏è Dynamic Adjustments
                        </div>

                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="ai-exit-dynamic-tp" checked>
                                <span>üéØ Dynamic Take Profit - The AI model optimizes TP levels.</span>
                            </label>

                            <label class="checkbox-label">
                                <input type="checkbox" id="ai-exit-dynamic-sl" checked>
                                <span>üõ°Ô∏è Dynamic Stop Loss - The AI model optimizes SL levels.</span>
                            </label>

                            <label class="checkbox-label">
                                <input type="checkbox" id="ai-exit-adapt-regime" checked>
                                <span>üìä Market Regime Adaptation - Adjusts based on Trend/Range/Volatile status.</span>
                            </label>

                            <label class="checkbox-label">
                                <input type="checkbox" id="ai-exit-volatility-scaling" checked>
                                <span>üìà Volatility Scaling - Scales targets based on ATR-based volatility.</span>
                            </label>
                        </div>
                    </div>

                    <!-- Regime Multipliers -->
                    <div style="background: var(--bg-secondary); border: 2px solid var(--border-primary); border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
                        <div style="font-weight: 600; font-size: 0.9375rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-primary);">
                            üìä Market Regime Factors
                        </div>
                        <div class="form-help-text" style="margin-bottom: 1rem;">
                            In every market regime, the multipliers to be applied to TP/SL.
                        </div>

                        <!-- Trending Regime -->
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 600; font-size: 0.875rem; color: var(--text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üìà Trending (Trendli Piyasa)</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">TP Multiplier</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-trending-tp" value="1.5" min="0.1" max="5.0" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">SL Factor</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-trending-sl" value="0.8" min="0.1" max="5.0" step="0.1">
                                </div>
                            </div>
                        </div>

                        <!-- Ranging Regime -->
                        <div style="margin-bottom: 1rem;">
                            <div style="font-weight: 600; font-size: 0.875rem; color: var(--text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>‚ÜîÔ∏è Ranging (Yatay Piyasa)</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">TP Multiplier</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-ranging-tp" value="0.8" min="0.1" max="5.0" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">SL Factor</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-ranging-sl" value="1.2" min="0.1" max="5.0" step="0.1">
                                </div>
                            </div>
                        </div>

                        <!-- Volatile Regime -->
                        <div>
                            <div style="font-weight: 600; font-size: 0.875rem; color: var(--text-primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üí• Volatile (Volatil Piyasa)</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">TP Multiplier</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-volatile-tp" value="1.0" min="0.1" max="5.0" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">SL Factor</label>
                                    <input type="number" class="form-input" id="ai-exit-regime-volatile-sl" value="1.5" min="0.1" max="5.0" step="0.1">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ATR Multiplier Range -->
                    <div style="background: var(--bg-secondary); border: 2px solid var(--border-primary); border-radius: 0.5rem; padding: 1rem;">
                        <div style="font-weight: 600; font-size: 0.9375rem; color: var(--text-primary); margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-primary);">
                            üìä ATR Multiplier Range
                        </div>
                        <div class="form-help-text" style="margin-bottom: 1rem;">
                            Volatility-based scaling ATR factor range.
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">
                                    Minimum ATR Multiplier
                                    <span class="label-help" title="Minimum multiplier to be used with low volatility.">‚ÑπÔ∏è</span>
                                </label>
                                <input type="number" class="form-input" id="ai-exit-atr-min" value="1.0" min="0.1" max="10.0" step="0.1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    Maximum ATR Multiplier
                                    <span class="label-help" title="Maximum multiplier to be used with high volatility.">‚ÑπÔ∏è</span>
                                </label>
                                <input type="number" class="form-input" id="ai-exit-atr-max" value="3.0" min="0.1" max="10.0" step="0.1">
                            </div>
                        </div>
                    </div>

                    <!-- Info Box -->
                    <div class="info-box" style="margin-top: 1rem;">
                        <div class="info-box-title">üí° How does AI Dynamic Exit work?</div>
                        <div class="info-box-content">
                            <p><strong>AI model analyzes the following factors:</strong></p>
                            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                                <li>üìä <strong>Piyasa Rejimi:</strong> Adjusts the TP/SL multipliers based on the trend, range, or volatility.</li>
                                <li>üìà <strong>Volatilite:</strong> ATR based scaling keeps the targets dynamic.</li>
                                <li>üéØ <strong>Tahmin:</strong> It determines the optimal exit point by predicting as far as the specified horizon.</li>
                                <li>‚öñÔ∏è <strong>Risk/Reward Dengesi:</strong> Calculates the optimal risk/reward ratio for each position.</li>
                            </ul>
                            <p style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border-primary);">
                                <strong>‚ö†Ô∏è Not:</strong> To use the AI exit, a pre-trained model is required. If a model is not available, classic exit strategies are used.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
